<div *ngIf="survey.questionGroups![indexQuestionGroup].questions!.length == 0" id="noQuestions" class="row mt-3 mb-2">
  <span class="alert alert-secondary">
      Zu diesem Frageblock wurden noch keine Fragen hinzugefügt.
  </span>
</div>
<div *ngIf="survey.questionGroups![indexQuestionGroup].questions!.length > 0" id="questionList">
  <table class="table table-hover">
    <thead>
    <tr>
      <th>#</th>
      <th>Typ</th>
      <th class="questionColumn">Frage</th>
      <th class="text-center">*</th>
      <th class="text-center">Ä/L</th>
    </tr>
    </thead>
    <tbody>
    <tr class="questionTableRow"
        *ngFor="let question of survey.questionGroups![indexQuestionGroup].questions; index as indexQuestion">
      <td>{{indexQuestion + 1}}</td>

      <td *ngIf="question.hasCheckbox">Auswahl</td>
      <td *ngIf="!question.hasCheckbox">Freitext</td>

      <td class="questionColumn">
        <span class="fw-bolder">{{ question.text }}</span>

        <div *ngIf="question!.hasCheckbox">
          <div class="d-flex flex-row my-1">
            <div *ngIf="question.checkboxGroup!.multipleSelect"
                 class="d-flex justify-content-evenly w-100">
              <span>
                Mehrfachauswahl: Ja
              </span>
              <span>
                Min.: {{ question.checkboxGroup!.minSelect }}
              </span>
              <span>
                Max.: {{ question.checkboxGroup!.maxSelect }}
              </span>
            </div>
            <div *ngIf="!question.checkboxGroup!.multipleSelect"
                 class="d-flex justify-content-evenly w-100">
              <span>
                  Mehrfachauswahl: Nein
              </span>
            </div>
          </div>
        </div>

        <checkbox-list [survey]="survey"
                       [indexQuestionGroup]="indexQuestionGroup"
                       [indexQuestion]="indexQuestion"></checkbox-list>
        <checkbox-form [survey]="survey"
                       [indexQuestionGroup]="indexQuestionGroup"
                       [indexQuestion]="indexQuestion"></checkbox-form>
      </td>

      <td class="text-center">
        <span *ngIf="question.required">
          Ja
        </span>
        <span *ngIf="!question.required">
          Nein
        </span>
      </td>

      <td>
        <div id="updateDeleteButton" class="d-flex">
          <button class="btn btn-primary me-1 p-1" type="button" title="Ändern" data-bs-toggle="modal"
                  (click)="openModal(question)"
                  [attr.data-bs-target]="'#confirmUpdateQuestion' + indexQuestion + 'Group' + indexQuestionGroup">
            <img src="assets/svgs/wrench.svg" alt="Ändern">
          </button>
          <button class="btn btn-danger p-1" type="button" title="Löschen" data-bs-toggle="modal"
                  [attr.data-bs-target]="'#confirmDeletionQuestion' + indexQuestion + 'Group' + indexQuestionGroup">
            <img src="assets/svgs/x-lg.svg" alt="Löschen">
          </button>

          <!-- Modal: Confirm Update -->
          <div class="modal fade" [attr.id]="'confirmUpdateQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
               tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="confirmUpdateLabel">Frage ändern</h5>
                </div>
                <form [formGroup]="updateForm"
                      (ngSubmit)="updateQuestion(indexQuestion)">
                  <div class="modal-body">
                    <label [attr.for]="'groupQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
                           class="form-label">
                      Fragentext:
                    </label>
                    <input [attr.id]="'groupQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
                           class="form-control" name="title" type="text"
                           formControlName="text" required>
                    <!--                    <div *ngIf="newQuestionText.invalid && (newQuestionText.dirty || newQuestionText.touched)"-->
                    <!--                         class="alert alert-danger p-2 m-0 mt-2">-->
                    <!--                      <div class="errorMessage" *ngIf="newQuestionText.errors?.required">-->
                    <!--                        Eine Frage benötigt einen Fragetext.-->
                    <!--                      </div>-->
                    <!--                    </div>-->
                    <div class="mt-3 ms-2">
                      <label [attr.for]="'requiredQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
                             class="form-check-label">
                        Erforderlich?&nbsp;&nbsp;
                      </label>
                      <input [attr.id]="'requiredQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
                             class="form-check-input" name="required"
                             type="checkbox" formControlName="required">
                    </div>
                  </div>
                  <div *ngIf="question.hasCheckbox">
                    <hr>
                    <div class="container">
                      <div class="row mb-3" formGroupName="checkboxGroup">
                        <div class="col">
                          <label [attr.for]="'multipleSelectQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
                                 class="form-check-label">
                            Mehrfachauswahl?&nbsp;&nbsp;
                          </label>
                          <input [attr.id]="'multipleSelectQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
                                 class="form-check-input" name="multipleSelect" type="checkbox"
                                 formControlName="multipleSelect">
                        </div>
                        <div class="col">
                          <label [attr.for]="'minSelectQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
                                 class="form-label">
                            Minimum:
                          </label>
                          <input [attr.id]="'minSelectQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
                                 class="form-control" name="minSelect" type="number" min="0"
                                 formControlName="minSelect">
                          <!--                          <div *ngIf="minSelect.invalid && (minSelect.dirty || minSelect.touched)"-->
                          <!--                               class="alert alert-danger p-2 mt-1 mb-0">-->
                          <!--                            <div *ngIf="minSelect.errors?.min">-->
                          <!--                              Das Minimum muss mind. 0 sein.-->
                          <!--                            </div>-->
                          <!--                          </div>-->
                        </div>
                        <div class="col">
                          <label [attr.for]="'maxSelectQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
                                 class="form-label">
                            Maximal:
                          </label>
                          <input [attr.id]="'maxSelectQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
                                 class="form-control" name="maxSelect" type="number" min="2"
                                 formControlName="maxSelect">
                          <!--                          <div *ngIf="maxSelect.invalid && (maxSelect.dirty || maxSelect.touched)"-->
                          <!--                               class="alert alert-danger p-2 mt-1 mb-0">-->
                          <!--                            <div *ngIf="maxSelect.errors?.min">-->
                          <!--                              Das Maximum muss mind. 2 sein.-->
                          <!--                            </div>-->
                          <!--                          </div>-->
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="submit" class="btn btn-primary" data-bs-dismiss="modal">
                      Änderungen Speichern
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>

          <!-- Modal: Confirm deletion -->
          <div class="modal fade" [attr.id]="'confirmDeletionQuestion' + indexQuestion + 'Group' + indexQuestionGroup"
               tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="confirmDeletionLabel">Frage löschen</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  Sind Sie sicher? Sie können die Frage nicht wiederherstellen.
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">
                    Abbrechen
                  </button>
                  <button type="submit" class="btn btn-danger" data-bs-dismiss="modal"
                          (click)="deleteQuestion(indexQuestion)">
                    Ja, löschen.
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </td>
    </tr>
    </tbody>
  </table>
</div>
